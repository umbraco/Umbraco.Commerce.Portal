@using Umbraco.Commerce.Portal.Models
@using Umbraco.Commerce.Portal.Services
@inject PortalMemberService PortalMemberService
@inherits UmbracoViewPage
@{
    Layout = "UmbracoCommercePortalManagementLayout.cshtml";

    var isLoggedIn = Context.User?.Identity?.IsAuthenticated ?? false;

    var accountModel = new AccountModel();
    if (isLoggedIn)
    {
        accountModel = PortalMemberService.Get(Context.User!.Identity!.Name!);
    }
}

@await Html.PartialAsync(
    $"{UmbracoCommercePortalConstants.UmbracoCommercePortalViewPath}/Partials/UmbracoCommercePortalManagementHeader.cshtml",
    new ManagementPageHeader(
        Umbraco.GetDictionaryValueOrDefault(UmbracoCommercePortalConstants.Localization.AccountEntries.MyAccount.Key, UmbracoCommercePortalConstants.Localization.AccountEntries.MyAccount.DefaultValue),
        Umbraco.GetDictionaryValueOrDefault(UmbracoCommercePortalConstants.Localization.AccountEntries.ManageAccountDetails.Key, UmbracoCommercePortalConstants.Localization.AccountEntries.ManageAccountDetails.DefaultValue)))

<div class="main__content" id="mainContent">
    @using (Html.BeginUmbracoForm("UpdateAccount", "UmbracoCommercePortalAccountSurface", FormMethod.Post, new { @class = "form" }))
    {
        <input type="hidden" asp-for="@accountModel.Id" />

        <div class="form__section">
            <h3 class="form__section-title">
                @Umbraco.GetDictionaryValueOrDefault(UmbracoCommercePortalConstants.Localization.AccountEntries.PersonalInformation.Key, UmbracoCommercePortalConstants.Localization.AccountEntries.PersonalInformation.DefaultValue)
            </h3>

            <div class="form__row">
                <div class="form__field">
                    <label asp-for="@accountModel.FirstName" class="form__label">
                        @Umbraco.GetDictionaryValueOrDefault(UmbracoCommercePortalConstants.Localization.AccountEntries.FirstName.Key, UmbracoCommercePortalConstants.Localization.AccountEntries.FirstName.DefaultValue)
                    </label>
                    <input type="text" asp-for="@accountModel.FirstName" class="form__input" />
                </div>
                <div class="form__field">
                    <label asp-for="@accountModel.LastName" class="form__label">
                        @Umbraco.GetDictionaryValueOrDefault(UmbracoCommercePortalConstants.Localization.AccountEntries.LastName.Key, UmbracoCommercePortalConstants.Localization.AccountEntries.LastName.DefaultValue)
                    </label>
                    <input type="text" asp-for="@accountModel.LastName" class="form__input" />
                </div>
            </div>

            <div class="form__row">
                <div class="form__field form__field--full">
                    <label asp-for="@accountModel.Email" class="form__label">
                        @Umbraco.GetDictionaryValueOrDefault(UmbracoCommercePortalConstants.Localization.AccountEntries.EmailAddress.Key, UmbracoCommercePortalConstants.Localization.AccountEntries.EmailAddress.DefaultValue)
                    </label>
                    <input type="email" asp-for="@accountModel.Email" class="form__input" />
                </div>
            </div>
        </div>

        <div class="form__section">
            <h3 class="form__section-title">
                @Umbraco.GetDictionaryValueOrDefault(UmbracoCommercePortalConstants.Localization.AccountEntries.BillingInformation.Key, UmbracoCommercePortalConstants.Localization.AccountEntries.BillingInformation.DefaultValue)
            </h3>

            <div class="form__row">
                <div class="form__field form__field--full">
                    <label for="country" class="form__label">
                        @Umbraco.GetDictionaryValueOrDefault(UmbracoCommercePortalConstants.Localization.AccountEntries.Country.Key, UmbracoCommercePortalConstants.Localization.AccountEntries.Country.DefaultValue)
                    </label>
                    <select id="country" name="country" class="form__select">
                        <option value="US">United States</option>
                        <option value="CA">Canada</option>
                        <option value="GB">United Kingdom</option>
                        <option value="DE">Germany</option>
                        <option value="FR">France</option>
                        <option value="AU">Australia</option>
                    </select>
                </div>
            </div>

            <div class="form__row">
                <div class="form__field form__field--full">
                    <label asp-for="@accountModel.Street" class="form__label">
                        @Umbraco.GetDictionaryValueOrDefault(UmbracoCommercePortalConstants.Localization.AccountEntries.StreetAddress.Key, UmbracoCommercePortalConstants.Localization.AccountEntries.StreetAddress.DefaultValue)
                    </label>
                    <input type="text" asp-for="@accountModel.Street" class="form__input" />
                </div>
            </div>

            <div class="form__row">
                <div class="form__field">
                    <label asp-for="@accountModel.City" class="form__label">
                        @Umbraco.GetDictionaryValueOrDefault(UmbracoCommercePortalConstants.Localization.AccountEntries.City.Key, UmbracoCommercePortalConstants.Localization.AccountEntries.City.DefaultValue)
                    </label>
                    <input type="text" asp-for="@accountModel.City" class="form__input" />
                </div>
                <div class="form__field">
                    <label asp-for="@accountModel.State" class="form__label">
                        @Umbraco.GetDictionaryValueOrDefault(UmbracoCommercePortalConstants.Localization.AccountEntries.State.Key, UmbracoCommercePortalConstants.Localization.AccountEntries.State.DefaultValue)
                    </label>
                    <input type="text" asp-for="@accountModel.State" class="form__input" />
                </div>
                <div class="form__field">
                    <label asp-for="@accountModel.ZipCode" class="form__label">
                        @Umbraco.GetDictionaryValueOrDefault(UmbracoCommercePortalConstants.Localization.AccountEntries.ZipCode.Key, UmbracoCommercePortalConstants.Localization.AccountEntries.ZipCode.DefaultValue)
                    </label>
                    <input type="text" asp-for="@accountModel.ZipCode" class="form__input" />
                </div>
            </div>
        </div>

        <div class="auth__field">
            <div class="auth__error">
                @Html.ValidationSummary()
            </div>
        </div>

        <div class="form__actions">
            <button type="button" class="button button--secondary">Cancel</button>
            <button type="submit" class="button button--primary">Save</button>
        </div>
    }
</div>

@if (TempData["Success"] != null)
{
    @await Html.PartialAsync($"{UmbracoCommercePortalConstants.UmbracoCommercePortalViewPath}/Partials/UmbracoCommercePortalToast.cshtml",
        new ToastModel("success", TempData["Success"].ToString()))
}
