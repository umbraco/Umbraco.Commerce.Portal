@using Umbraco.Commerce.Portal.Models
@using Umbraco.Commerce.Portal.Services
@inject PortalMemberService PortalMemberService
@inherits UmbracoViewPage
@{
    Layout = "UmbracoCommercePortalManagementLayout.cshtml";

    var isLoggedIn = Context.User?.Identity?.IsAuthenticated ?? false;

    var accountModel = new AccountModel();
    if (isLoggedIn)
    {
        accountModel = PortalMemberService.Get(Context.User!.Identity!.Name!);
    }
}

@await Html.PartialAsync(
    $"{UmbracoCommercePortalConstants.UmbracoCommercePortalViewPath}/Partials/UmbracoCommercePortalManagementHeader.cshtml",
    new ManagementPageHeader("My Account", "Manage your account details and preferences"))

<div class="main__content" id="mainContent">
    @using (Html.BeginUmbracoForm("UpdateAccount", "UmbracoCommercePortalAccountSurface", FormMethod.Post, new { @class = "form" }))
    {
        <input type="hidden" asp-for="@accountModel.Id" />

        <div class="form__section">
            <h3 class="form__section-title">Personal Information</h3>

            <div class="form__row">
                <div class="form__field">
                    <label asp-for="@accountModel.FirstName" class="form__label">First name</label>
                    <input type="text" asp-for="@accountModel.FirstName" class="form__input" />
                </div>
                <div class="form__field">
                    <label asp-for="@accountModel.LastName" class="form__label">Last name</label>
                    <input type="text" asp-for="@accountModel.LastName" class="form__input" />
                </div>
            </div>

            <div class="form__row">
                <div class="form__field form__field--full">
                    <label asp-for="@accountModel.Email" class="form__label">Email address</label>
                    <input type="email" asp-for="@accountModel.Email" class="form__input" />
                </div>
            </div>
        </div>

        <div class="form__section">
            <h3 class="form__section-title">Billing Information</h3>

            <div class="form__row">
                <div class="form__field form__field--full">
                    <label for="country" class="form__label">Country</label>
                    <select id="country" name="country" class="form__select">
                        <option value="US">United States</option>
                        <option value="CA">Canada</option>
                        <option value="GB">United Kingdom</option>
                        <option value="DE">Germany</option>
                        <option value="FR">France</option>
                        <option value="AU">Australia</option>
                    </select>
                </div>
            </div>

            <div class="form__row">
                <div class="form__field form__field--full">
                    <label asp-for="@accountModel.Street" class="form__label">Street address</label>
                    <input type="text" asp-for="@accountModel.Street" class="form__input" />
                </div>
            </div>

            <div class="form__row">
                <div class="form__field">
                    <label asp-for="@accountModel.City" class="form__label">City</label>
                    <input type="text" asp-for="@accountModel.City" class="form__input" />
                </div>
                <div class="form__field">
                    <label asp-for="@accountModel.State" class="form__label">State / Province</label>
                    <input type="text" asp-for="@accountModel.State" class="form__input" />
                </div>
                <div class="form__field">
                    <label asp-for="@accountModel.ZipCode" class="form__label">ZIP / Postal code</label>
                    <input type="text" asp-for="@accountModel.ZipCode" class="form__input" />
                </div>
            </div>
        </div>

        <div class="auth__field">
            <div class="auth__error">
                @Html.ValidationSummary()
            </div>
        </div>

        <div class="form__actions">
            <button type="button" class="button button--secondary">Cancel</button>
            <button type="submit" class="button button--primary">Save</button>
        </div>
    }
</div>

@if (TempData["Success"] != null)
{
    @await Html.PartialAsync($"{UmbracoCommercePortalConstants.UmbracoCommercePortalViewPath}/Partials/UmbracoCommercePortalToast.cshtml",
        new ToastModel("success", TempData["Success"].ToString()))
}
