@using Umbraco.Cms.Web.Common.Models
@using Umbraco.Cms.Web.Website.Controllers
@using Umbraco.Commerce.Portal.Extensions

@inherits UmbracoViewPage
@{
    Layout = "UmbracoCommercePortalAuthLayout.cshtml";

    var registerPage = Model.GetRegisterPage();
    var forgotPasswordPage = Model.GetResetPasswordPage();
    var myAccountPage = Model.GetResetPasswordPage(); // TODO - this should be the My Account page

    var loginModel = new LoginModel();
}

<h2 class="auth__title">Sign in to your account</h2>

@using (Html.BeginUmbracoForm<UmbLoginController>("HandleLogin",
    new { RedirectUrl = myAccountPage != null ? myAccountPage.Url() : "/" },
    new { @class = "auth__form" }))
{
    <div class="auth__field">
        <label class="auth__label" asp-for="@loginModel.Username">Email address</label>
        <input class="auth__input" asp-for="@loginModel.Username" />
    </div>

    <div class="auth__field">
        <div class="auth__label-wrapper">
            <label class="auth__label" asp-for="@loginModel.Password">Password</label>
            <a class="auth__link auth__link--right" href="@(forgotPasswordPage != null ? forgotPasswordPage.Url() : "#")">Forgot password?</a>
        </div>
        <input class="auth__input" asp-for="@loginModel.Password" type="password" />
    </div>

    <div class="auth__field">
        <div class="auth__error">
            @Html.ValidationSummary()
        </div>
    </div>

    <button class="auth__button" type="submit">Sign in</button>
}

@await Html.PartialAsync($"{UmbracoCommercePortalConstants.UmbracoCommercePortalViewPath}/Partials/UmbracoCommercePortalSignUp.cshtml")
